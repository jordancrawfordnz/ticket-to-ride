<% content_for :title, "Game" %>

<p id="notice"><%= notice %></p>

<% if flash[:errors] %>
  Errors:
  <% flash[:errors].each do |error| %>
    <div class="error">- <%= error %></div>
  <% end %>
  <br>
<% end %>

<h1><%= "#{@player.name} - #{@player.colour}" %></h1>
You have <strong class="train-piece-count"><%= @player.train_pieces %></strong> train pieces

<h3>My Train Car Cards</h3>
<% @player.dealt_train_cars.each do |dealt_train_car| %>
  <div class="train-car">- <%= dealt_train_car.train_car_type.name %></div>
  <br>
<% end %>

<h2>My Turn</h2>
<%= button_to 'Draw more cards', action: :draw_train_cars, id: @game.id %>

<br>
<%= link_to 'Back', games_path, action: :get %>

<h3>Routes</h3>
<div class="routes">
  <% @all_routes.each do |city| %>
    <div class="route">
      <strong><%= city[:name] %></strong>
      <% city[:destinations].each do |destination| %>
        <div class="destination">
          City: <%= destination[:name] %><br>
          Pieces: <%= destination[:pieces] %><br>
          Colour: <%= destination[:route_colour] %><br>
          <% if destination[:is_claimed?] %>
            <%= destination[:claimed_player] %>
          <% else %>
            <%= form_tag new_game_claim_route_path(@game), method: :get do %>
              <%= hidden_field_tag :route_id, destination[:route_id] %>
              <%= submit_tag "Claim Route", name: nil %>
            <% end %>
          <% end %>
        </div>
        <br>
      <% end %>
    </div>
  <% end %>
</div>
